{"ast":null,"code":"import { ERROR_MESSAGE } from './errors';\n/**\n * Copyright (c) 2022\n *\n * Utilities related to reading configuration objects\n *\n * @summary Config-related utils\n * @author Ayon Ghosh <ayon.ghosh@thoughtspot.com>\n */\n\nconst urlRegex = new RegExp(['(^(https?:)//)?', '(([^:/?#]*)(?::([0-9]+))?)', '(/{0,1}[^?#]*)', '(\\\\?[^#]*|)', '(#.*|)$' // hash\n].join(''));\n/**\n * Parse and construct the ThoughtSpot hostname or IP address\n * from the embed configuration object.\n * @param config\n */\n\nexport const getThoughtSpotHost = config => {\n  const urlParts = config.thoughtSpotHost.match(urlRegex);\n\n  if (!urlParts) {\n    throw new Error(ERROR_MESSAGE.INVALID_THOUGHTSPOT_HOST);\n  }\n\n  const protocol = urlParts[2] || window.location.protocol;\n  const host = urlParts[3];\n  let path = urlParts[6]; // Lose the trailing / if any\n\n  if (path.charAt(path.length - 1) === '/') {\n    path = path.substring(0, path.length - 1);\n  } // const urlParams = urlParts[7];\n  // const hash = urlParts[8];\n\n\n  return `${protocol}//${host}${path}`;\n};\nexport const getV2BasePath = config => {\n  if (config.basepath) {\n    return config.basepath;\n  }\n\n  const tsHost = getThoughtSpotHost(config); // This is to handle when e2e's. Search is run on pods for comp-blink-test-pipeline\n  // with baseUrl=https://localhost:8443.\n  // This is to handle when the developer is developing in their local environment.\n\n  if (tsHost.includes('://localhost') && !tsHost.includes(':8443')) {\n    return '';\n  }\n\n  return 'v2';\n};\n/**\n * It is a good idea to keep URLs under 2000 chars.\n * If this is ever breached, since we pass view configuration through\n * URL params, we would like to log a warning.\n * Reference: https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url-in-different-browsers\n */\n\nexport const URL_MAX_LENGTH = 2000;\n/**\n * The default CSS dimensions of the embedded app\n */\n\nexport const DEFAULT_EMBED_WIDTH = '100%';\nexport const DEFAULT_EMBED_HEIGHT = '100%';","map":{"version":3,"mappings":"AAAA,SAASA,aAAT,QAA8B,UAA9B;AAGA;;;;;;;;;AASA,MAAMC,QAAQ,GAAG,IAAIC,MAAJ,CACb,CACI,iBADJ,EAEI,4BAFJ,EAGI,gBAHJ,EAII,aAJJ,EAKI,SALJ,CAKe;AALf,EAMEC,IANF,CAMO,EANP,CADa,CAAjB;AAUA;;;;;;AAKA,OAAO,MAAMC,kBAAkB,GAAIC,MAAD,IAAgC;EAC9D,MAAMC,QAAQ,GAAGD,MAAM,CAACE,eAAP,CAAuBC,KAAvB,CAA6BP,QAA7B,CAAjB;;EACA,IAAI,CAACK,QAAL,EAAe;IACX,MAAM,IAAIG,KAAJ,CAAUT,aAAa,CAACU,wBAAxB,CAAN;EACH;;EAED,MAAMC,QAAQ,GAAGL,QAAQ,CAAC,CAAD,CAAR,IAAeM,MAAM,CAACC,QAAP,CAAgBF,QAAhD;EACA,MAAMG,IAAI,GAAGR,QAAQ,CAAC,CAAD,CAArB;EACA,IAAIS,IAAI,GAAGT,QAAQ,CAAC,CAAD,CAAnB,CAR8D,CAS9D;;EACA,IAAIS,IAAI,CAACC,MAAL,CAAYD,IAAI,CAACE,MAAL,GAAc,CAA1B,MAAiC,GAArC,EAA0C;IACtCF,IAAI,GAAGA,IAAI,CAACG,SAAL,CAAe,CAAf,EAAkBH,IAAI,CAACE,MAAL,GAAc,CAAhC,CAAP;EACH,CAZ6D,CAa9D;EACA;;;EAEA,OAAO,GAAGN,QAAQ,KAAKG,IAAI,GAAGC,IAAI,EAAlC;AACH,CAjBM;AAmBP,OAAO,MAAMI,aAAa,GAAId,MAAD,IAAgC;EACzD,IAAIA,MAAM,CAACe,QAAX,EAAqB;IACjB,OAAOf,MAAM,CAACe,QAAd;EACH;;EAED,MAAMC,MAAM,GAAGjB,kBAAkB,CAACC,MAAD,CAAjC,CALyD,CAOzD;EACA;EACA;;EACA,IAAIgB,MAAM,CAACC,QAAP,CAAgB,cAAhB,KAAmC,CAACD,MAAM,CAACC,QAAP,CAAgB,OAAhB,CAAxC,EAAkE;IAC9D,OAAO,EAAP;EACH;;EAED,OAAO,IAAP;AACH,CAfM;AAiBP;;;;;;;AAMA,OAAO,MAAMC,cAAc,GAAG,IAAvB;AAEP;;;;AAGA,OAAO,MAAMC,mBAAmB,GAAG,MAA5B;AACP,OAAO,MAAMC,oBAAoB,GAAG,MAA7B","names":["ERROR_MESSAGE","urlRegex","RegExp","join","getThoughtSpotHost","config","urlParts","thoughtSpotHost","match","Error","INVALID_THOUGHTSPOT_HOST","protocol","window","location","host","path","charAt","length","substring","getV2BasePath","basepath","tsHost","includes","URL_MAX_LENGTH","DEFAULT_EMBED_WIDTH","DEFAULT_EMBED_HEIGHT"],"sourceRoot":"","sources":["../../src/config.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}