import React from 'react';
import useDeepCompareEffect from 'use-deep-compare-effect';
import { SearchEmbed as _SearchEmbed } from '../embed/search';
import { AppEmbed as _AppEmbed } from '../embed/app';
import { LiveboardEmbed as _LiveboardEmbed, } from '../embed/liveboard';
import { getViewPropsAndListeners } from './util';
const componentFactory = (EmbedConstructor) => React.forwardRef((props, forwardedRef) => {
    const ref = React.useRef(null);
    const { className, ...embedProps } = props;
    const { viewConfig, listeners } = getViewPropsAndListeners(embedProps);
    useDeepCompareEffect(() => {
        const tsEmbed = new EmbedConstructor(ref.current, {
            ...viewConfig,
        });
        Object.keys(listeners).forEach((eventName) => {
            tsEmbed.on(eventName, listeners[eventName]);
        });
        tsEmbed.render();
        if (forwardedRef) {
            // eslint-disable-next-line no-param-reassign
            forwardedRef.current = tsEmbed;
        }
    }, [viewConfig, listeners]);
    return (React.createElement("div", { "data-testid": "tsEmbed", ref: ref, className: className }));
});
export const SearchEmbed = componentFactory(_SearchEmbed);
export const AppEmbed = componentFactory(_AppEmbed);
export const LiveboardEmbed = componentFactory(_LiveboardEmbed);
export const PinboardEmbed = componentFactory(_LiveboardEmbed);
export const useEmbedRef = () => {
    return React.useRef(null);
};
//# sourceMappingURL=index.js.map